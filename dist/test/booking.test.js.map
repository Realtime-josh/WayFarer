{"version":3,"sources":["../../server/test/booking.test.js"],"names":["describe","before","done","then","catch","e","it","app","post","send","tripId","seatNumber","set","expect","response","body","status","toBe","error","toContain"],"mappings":";;AAAA;;;;AACA;;;;AACA;;;;AACA;;;;AAEAA,SAAS,+BAAT,EAA0C,YAAM;AAC9CC,SAAO,UAACC,IAAD,EAAU;AACf,iCACGC,IADH,CACQ,YAAM;AACVD;AACD,KAHH,EAIGE,KAJH,CAIS;AAAA,aAAKF,KAAKG,CAAL,CAAL;AAAA,KAJT;AAKD,GAND;;AAQAC,KAAG,2DAAH,EAAgE;AAAA,WAAM,yBAAQC,aAAR,EACnEC,IADmE,CAC9D,kBAD8D,EAEnEC,IAFmE,CAE9D;AACJC,cAAQ,KADJ;AAEJC,kBAAY;AAFR,KAF8D,EAMnEC,GANmE,CAM/D,QAN+D,EAMrD,kBANqD,EAOnEA,GAPmE,CAO/D,eAP+D,EAO9C,8PAP8C,EAQnEC,MARmE,CAQ5D,GAR4D,EASnEV,IATmE,CAS9D,UAACW,QAAD,EAAc;AAClB,4BAAOA,SAASC,IAAT,CAAcC,MAArB,EAA6BC,IAA7B,CAAkC,GAAlC;AACA,4BAAOH,SAASC,IAAT,CAAcG,KAArB,EAA4BC,SAA5B,CAAsC,gCAAtC;AACD,KAZmE,CAAN;AAAA,GAAhE;;AAcAb,KAAG,2CAAH,EAAgD;AAAA,WAAM,yBAAQC,aAAR,EACnDC,IADmD,CAC9C,kBAD8C,EAEnDC,IAFmD,CAE9C;AACJE,kBAAY;AADR,KAF8C,EAKnDC,GALmD,CAK/C,QAL+C,EAKrC,kBALqC,EAMnDA,GANmD,CAM/C,eAN+C,EAM9B,8PAN8B,EAOnDC,MAPmD,CAO5C,GAP4C,EAQnDV,IARmD,CAQ9C,UAACW,QAAD,EAAc;AAClB,4BAAOA,SAASC,IAAT,CAAcC,MAArB,EAA6BC,IAA7B,CAAkC,GAAlC;AACA,4BAAOH,SAASC,IAAT,CAAcG,KAArB,EAA4BC,SAA5B,CAAsC,uBAAtC;AACD,KAXmD,CAAN;AAAA,GAAhD;;AAaAb,KAAG,oDAAH,EAAyD;AAAA,WAAM,yBAAQC,aAAR,EAC5DC,IAD4D,CACvD,kBADuD,EAE5DC,IAF4D,CAEvD;AACJC,cAAQ,CADJ;AAEJC,kBAAY;AAFR,KAFuD,EAM5DC,GAN4D,CAMxD,QANwD,EAM9C,kBAN8C,EAO5DA,GAP4D,CAOxD,eAPwD,EAOvC,8PAPuC,EAQ5DC,MAR4D,CAQrD,GARqD,EAS5DV,IAT4D,CASvD,UAACW,QAAD,EAAc;AAClB,4BAAOA,SAASC,IAAT,CAAcC,MAArB,EAA6BC,IAA7B,CAAkC,GAAlC;AACA,4BAAOH,SAASC,IAAT,CAAcG,KAArB,EAA4BC,SAA5B,CAAsC,yEAAtC;AACD,KAZ4D,CAAN;AAAA,GAAzD;AAaD,CAjDD","file":"booking.test.js","sourcesContent":["import expect from 'expect';\nimport request from 'supertest';\nimport app from '../app';\nimport { clearBookingTable } from '../crud/db';\n\ndescribe('POST /bookings, GET /bookings', () => {\n  before((done) => {\n    clearBookingTable()\n      .then(() => {\n        done();\n      })\n      .catch(e => done(e));\n  });\n\n  it('should raise error for no trip record for signed in admin', () => request(app)\n    .post('/api/v1/bookings')\n    .send({\n      tripId: 30000,\n      seatNumber: 2,\n    })\n    .set('Accept', 'application/json')\n    .set('Authorization', 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjYzLCJmaXJzdE5hbWUiOiJKYWNvYiIsImxhc3ROYW1lIjoiTW9vcmUiLCJlbWFpbCI6ImphY29ubW9vcmVAd2F5ZmFyZXJhZG1pbi5jb20iLCJpc0FkbWluIjp0cnVlLCJpYXQiOjE1NjIxODc4Njd9.QxKWLYmLbt_YzkuOcnm6znMgx6iuFFHwFwGn715DPNc')\n    .expect(404)\n    .then((response) => {\n      expect(response.body.status).toBe(404);\n      expect(response.body.error).toContain('Could not get trip Information');\n    }));\n\n  it('should raise error for an undefined input', () => request(app)\n    .post('/api/v1/bookings')\n    .send({\n      seatNumber: 2,\n    })\n    .set('Accept', 'application/json')\n    .set('Authorization', 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjYzLCJmaXJzdE5hbWUiOiJKYWNvYiIsImxhc3ROYW1lIjoiTW9vcmUiLCJlbWFpbCI6ImphY29ubW9vcmVAd2F5ZmFyZXJhZG1pbi5jb20iLCJpc0FkbWluIjp0cnVlLCJpYXQiOjE1NjIxODc4Njd9.QxKWLYmLbt_YzkuOcnm6znMgx6iuFFHwFwGn715DPNc')\n    .expect(403)\n    .then((response) => {\n      expect(response.body.status).toBe(403);\n      expect(response.body.error).toContain('Missing input details');\n    }));\n\n  it('should raise error for booking a seat more than 36', () => request(app)\n    .post('/api/v1/bookings')\n    .send({\n      tripId: 2,\n      seatNumber: 39,\n    })\n    .set('Accept', 'application/json')\n    .set('Authorization', 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjYzLCJmaXJzdE5hbWUiOiJKYWNvYiIsImxhc3ROYW1lIjoiTW9vcmUiLCJlbWFpbCI6ImphY29ubW9vcmVAd2F5ZmFyZXJhZG1pbi5jb20iLCJpc0FkbWluIjp0cnVlLCJpYXQiOjE1NjIxODc4Njd9.QxKWLYmLbt_YzkuOcnm6znMgx6iuFFHwFwGn715DPNc')\n    .expect(403)\n    .then((response) => {\n      expect(response.body.status).toBe(403);\n      expect(response.body.error).toContain('Ensure all fields are filled in correctly.Maximum number of seats is 36');\n    }));\n});\n"]}